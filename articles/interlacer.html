<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="interlacer">
<title>Introduction to interlacer • interlacer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to interlacer">
<meta property="og:description" content="interlacer">
<meta property="og:image" content="http://kylehusmann.com/interlacer/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script data-goatcounter="https://interlacer.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">interlacer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/interlacer.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/extended-column-types.html">Extended Column Types</a>
    <a class="dropdown-item" href="../articles/coded-data.html">Coded Data</a>
    <a class="dropdown-item" href="../articles/other-approaches.html">Other Approaches</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/khusmann/interlacer/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to interlacer</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/khusmann/interlacer/blob/HEAD/vignettes/interlacer.Rmd" class="external-link"><code>vignettes/interlacer.Rmd</code></a></small>
      <div class="d-none name"><code>interlacer.Rmd</code></div>
    </div>

    
    
<p>In many datasets, reasons for missing values are interlaced with data
as special values or codes. For example, consider the following CSV:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/khusmann/interlacer" class="external-link">interlacer</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_file.html" class="external-link">read_file</a></span><span class="op">(</span><span class="fu"><a href="../reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; person_id,age,favorite_color</span></span>
<span><span class="co">#&gt; 1,20,BLUE</span></span>
<span><span class="co">#&gt; 2,REFUSED,BLUE</span></span>
<span><span class="co">#&gt; 3,21,REFUSED</span></span>
<span><span class="co">#&gt; 4,30,OMITTED</span></span>
<span><span class="co">#&gt; 5,1,N/A</span></span>
<span><span class="co">#&gt; 6,41,RED</span></span>
<span><span class="co">#&gt; 7,50,OMITTED</span></span>
<span><span class="co">#&gt; 8,30,YELLOW</span></span>
<span><span class="co">#&gt; 9,REFUSED,REFUSED</span></span>
<span><span class="co">#&gt; 10,OMITTED,RED</span></span>
<span><span class="co">#&gt; 11,10,REFUSED</span></span></code></pre></div>
<p>This csv data source has three variables: <code>person_id</code> and
<code>age</code>, both numeric variables and
<code>favorite_color</code>, a character or factor variable. Interlaced
in their values are three possible missing reasons:
<code>REFUSED</code>, <code>OMITTED</code>, and <code>N/A</code>.</p>
<p>To load the values of this data source, it is an easy call to the
venerable <code><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">readr::read_csv()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">df_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REFUSED"</span>, <span class="st">"OMITTED"</span>, <span class="st">"N/A"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id   age favorite_color</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1    20 BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2    <span style="color: #BB0000;">NA</span> BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3    21 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4    30 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5     1 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6    41 RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7    50 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8    30 YELLOW        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10    <span style="color: #BB0000;">NA</span> RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11    10 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>As you can see, the data were loaded into a dataframe with three
columns, and all of the missing reasons were replaced with
<code>NA</code> values.</p>
<div class="section level2">
<h2 id="aggregations-with-missing-reasons">Aggregations with missing reasons<a class="anchor" aria-label="anchor" href="#aggregations-with-missing-reasons"></a>
</h2>
<p>Now, if we were only interested in the <em>values</em> of our source
data, this functionality is all we need. But what if we wanted to know
<em>why</em> some values were <code>NA</code>? Although that information
was encoded in our source data, it was lost when all of the missing
reasons were converted into <code>NA</code> values.</p>
<p>For example, consider the <code>favorite_color</code> column. How
many respondents <code>REFUSED</code> to give their favorite color? How
many people just <code>OMITTED</code> their answer? Was the question
<code>N/A</code> for some respondents (e.g. wasn’t on their survey
form)? What was the mean respondent age for each of these groups?</p>
<p>Our current dataframe only gets us part way:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_simple</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">favorite_color</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">favorite_color</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   favorite_color mean_age     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BLUE               20       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> RED                41       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> YELLOW             30       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">NA</span>                 22.4     6</span></span></code></pre></div>
<p>As you can see, because we converted all our missing reasons into a
single <code>NA</code>, we can only answer these questions about
missingness in general, rather than work with the specific reasons
stored in our source data.</p>
<p>Unfortunately, if we try load our data with the missing reasons
intact, we lose something else: the type information of the values.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">df_with_missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span>,</span>
<span>  col_types <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/cols.html" class="external-link">cols</a></span><span class="op">(</span>.default <span class="op">=</span> <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id age     favorite_color</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1         20      BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2         REFUSED BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3         21      REFUSED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4         30      OMITTED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5         1       N/A           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6         41      RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7         50      OMITTED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8         30      YELLOW        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9         REFUSED REFUSED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10        OMITTED RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 11        10      REFUSED</span></span></code></pre></div>
<p>Now we have access to our missing reasons, but all the columns are
character vectors. This means that in order to do anything with our
values, we always have to filter out the missing reasons, and cast the
remaining values to our desired type:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">reasons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REFUSED"</span>, <span class="st">"OMITTED"</span>, <span class="st">"N/A"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_with_missing</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    age_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">age</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">reasons</span>, <span class="cn">NA</span>, <span class="va">age</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">age_values</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">favorite_color</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">favorite_color</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   favorite_color mean_age     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BLUE               20       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> N/A                 1       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> OMITTED            40       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> RED                41       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> REFUSED            15.5     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> YELLOW             30       1</span></span></code></pre></div>
<p>This gives us the information we want, but it is cumbersome. Notice
how there’s no distinction between favorite color values and missing
reasons! Things start to get really complex when different columns have
different sets of possible missing reasons. It means you have to do a
lot of type conversion gymnastics to switch between value types and
missing types.</p>
<div class="section level3">
<h3 id="the-interlacer-approach">The interlacer approach<a class="anchor" aria-label="anchor" href="#the-interlacer-approach"></a>
</h3>
<p>interlacer was built based on the insight that everything becomes
much more tidy, simple, and expressive when we explicitly work with
values and missing reasons as separate <em>channels</em> of the same
variable. interlacer introduces a new <code>interlaced</code> column
type that facilitates this. The <code>read_interlaced_*</code> functions
in interlacer import data with this new column type.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_interlaced_delim.html">read_interlaced_csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REFUSED"</span>, <span class="st">"OMITTED"</span>, <span class="st">"N/A"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20 BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1 <span style="color: #BB0000;">&lt;N/A&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41 RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30 YELLOW        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10 <span style="color: #BB0000;">&lt;REFUSED&gt;</span></span></span></code></pre></div>
<p>As you can see by the column headers, each column loaded is composed
of two channels: a value channel, and missing reason channel. Each
channel can have its own type. The <code>age</code> column, for example,
has <code>double</code> values and <code>factor</code> missing
reasons:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">age</span></span>
<span><span class="co">#&gt; &lt;interlaced&lt;dbl, fct&gt;[11]&gt;</span></span>
<span><span class="co">#&gt;  [1] 20        &lt;REFUSED&gt; 21        30        1         41        50       </span></span>
<span><span class="co">#&gt;  [8] 30        &lt;REFUSED&gt; &lt;OMITTED&gt; 10       </span></span>
<span><span class="co">#&gt; NA levels: REFUSED OMITTED N/A</span></span></code></pre></div>
<p>These channels can be explicitly accessed using the
<code><a href="../reference/value_channel.html">value_channel()</a></code> and <code><a href="../reference/value_channel.html">na_channel()</a></code> helper
functions:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/value_channel.html">value_channel</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 20 NA 21 30  1 41 50 30 NA NA 10</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/value_channel.html">na_channel</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] &lt;NA&gt;    REFUSED &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    &lt;NA&gt;    REFUSED</span></span>
<span><span class="co">#&gt; [10] OMITTED &lt;NA&gt;   </span></span>
<span><span class="co">#&gt; Levels: REFUSED OMITTED N/A</span></span></code></pre></div>
<p>These helpers are rarely needed, however, because computations
automatically operate on an <code>interlaced</code> column’s value
channel, and ignore the missing reasons channel. The following will
compute the mean age, without the missing reasons interfering:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 25.375</span></span></code></pre></div>
<p>(We could have equivalently used the <code><a href="../reference/value_channel.html">value_channel()</a></code>
helper to achieve the same result, albeit with more verbosity):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="../reference/value_channel.html">value_channel</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 25.375</span></span></code></pre></div>
<p>Although missing reasons are excluded in computations, they still
treated as unique values. This means that when we group by age we get a
breakdown by the unique missing reasons, rather than being lumped into a
single <code>NA</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">favorite_color</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">favorite_color</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   favorite_color mean_age     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> BLUE               20       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> RED                41       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> YELLOW             30       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span>          15.5     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #BB0000;">&lt;OMITTED&gt;</span>          40       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="color: #BB0000;">&lt;N/A&gt;</span>               1       1</span></span></code></pre></div>
<p>As you can see, we can generate the same report as we did before, but
without needing to do any type gymnastics! Also, the values are neatly
distinguished from the missing reasons.</p>
</div>
</div>
<div class="section level2">
<h2 id="filtering-based-on-missing-reasons">Filtering based on missing reasons<a class="anchor" aria-label="anchor" href="#filtering-based-on-missing-reasons"></a>
</h2>
<p><code>interlaced</code> columns are also helpful when creating
samples with inclusion / exclusion criteria based on missing reasons.
For example, using our example data, say we wanted to create a sample of
respondents that <code>REFUSED</code> to give their age. To indicate
that a value should be interpreted as a missing reason, you can use the
<code><a href="../reference/na.html">na()</a></code> function with the value:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">==</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REFUSED"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   person_id       age favorite_color</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># na_channel() can also be used to get an equivalent result:</span></span>
<span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/value_channel.html">na_channel</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span> <span class="op">==</span> <span class="st">"REFUSED"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   person_id       age favorite_color</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span></span></span></code></pre></div>
<p>How about people who <code>REFUSED</code> to report their age AND
favorite color?</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">==</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REFUSED"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">favorite_color</span> <span class="op">==</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REFUSED"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   person_id       age favorite_color</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span></span></span></code></pre></div>
<p>It’s also possible to combine value conditions with missing reason
conditions. For example, this will select everyone who
<code>REFUSED</code> to give their favorite color, and was over 20 years
old:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">age</span> <span class="op">&gt;</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="va">favorite_color</span> <span class="op">==</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REFUSED"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   person_id       age favorite_color</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="mutations">Mutations<a class="anchor" aria-label="anchor" href="#mutations"></a>
</h2>
<p>As you might expect, the <code><a href="../reference/na.html">na()</a></code> function can be used with
values in mutations. The following pipeline will replace the favorite
color of respondents with the missing value <code>"REDACTED"</code></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    favorite_color <span class="op">=</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REDACTED"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;???,fct&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10     <span style="color: #BB0000;">&lt;REDACTED&gt;</span></span></span></code></pre></div>
<p>Conditionals also work exactly as you would expect in mutations. The
following will replace the favorite color of respondents with
<code>age &lt; 18</code> with the missing reason
<code>"REDACTED_UNDERAGE"</code>. Respondents missing an age will be
replaced with <code>"REDACTED_MISSING_AGE"</code></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    favorite_color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span>,</span>
<span>      <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REDACTED_UNDERAGE"</span><span class="op">)</span>,</span>
<span>      <span class="va">favorite_color</span>,</span>
<span>      missing <span class="op">=</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REDACTED_MISSING_AGE"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20 BLUE                  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REDACTED_MISSING_AGE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1 <span style="color: #BB0000;">&lt;REDACTED_UNDERAGE&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41 RED                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30 YELLOW                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REDACTED_MISSING_AGE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> <span style="color: #BB0000;">&lt;REDACTED_MISSING_AGE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10 <span style="color: #BB0000;">&lt;REDACTED_UNDERAGE&gt;</span></span></span></code></pre></div>
<p>The following mutation will create a new column called
<code>person_type</code> that will be <code>"CHILD"</code> when
<code>age &lt; 18</code>, <code>"ADULT"</code> when
<code>age &gt;= 18</code>, and missing with reason
<code>"AGE_UNAVAILABLE"</code> when <code>age</code> is missing:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    person_type <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span>,</span>
<span>      <span class="st">"CHILD"</span>,</span>
<span>      <span class="st">"ADULT"</span>,</span>
<span>      missing <span class="op">=</span> <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"AGE_UNAVAILABLE"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 4</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color person_type      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20 BLUE           ADULT            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> BLUE           <span style="color: #BB0000;">&lt;AGE_UNAVAILABLE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      ADULT            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>      ADULT            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1 <span style="color: #BB0000;">&lt;N/A&gt;</span>          CHILD            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41 RED            ADULT            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>      ADULT            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30 YELLOW         ADULT            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #BB0000;">&lt;AGE_UNAVAILABLE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> RED            <span style="color: #BB0000;">&lt;AGE_UNAVAILABLE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      CHILD</span></span></code></pre></div>
<p>Important note: You must use <code><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">dplyr::if_else()</a></code> with
<code>interlaced</code> vectors instead of R’s
<code><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">base::ifelse()</a></code> function, because the base function strips
out the missing reason channel due to a <a href="https://vctrs.r-lib.org/#motivation" class="external-link">fundamental limitation in
base R</a>.</p>
</div>
<div class="section level2">
<h2 id="empty-cells-na-missing-reasons">Empty cells (<code>NA</code> missing reasons)<a class="anchor" aria-label="anchor" href="#empty-cells-na-missing-reasons"></a>
</h2>
<p>When a cell in a column is missing both a value and a missing reason,
the cell is considered “empty”. Such values can occur when missing
reasons are not specified. For example, if we did not include a
<code>missing =</code> argument in the second example in the previous
section, we would get the following result:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    favorite_color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span>,</span>
<span>      <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REDACTED_UNDERAGE"</span><span class="op">)</span>,</span>
<span>      <span class="va">favorite_color</span>,</span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color     </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20 BLUE               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1 <span style="color: #BB0000;">&lt;REDACTED_UNDERAGE&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41 RED                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30 YELLOW             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10 <span style="color: #BB0000;">&lt;REDACTED_UNDERAGE&gt;</span></span></span></code></pre></div>
<p>Empty values can be detected by using the <code><a href="../reference/is.empty.html">is.empty()</a></code>
function:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    favorite_color <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      <span class="va">age</span> <span class="op">&lt;</span> <span class="fl">18</span>,</span>
<span>      <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REDACTED_UNDERAGE"</span><span class="op">)</span>,</span>
<span>      <span class="va">favorite_color</span>,</span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/is.empty.html">is.empty</a></span><span class="op">(</span><span class="va">favorite_color</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   person_id       age favorite_color</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span></span></span></code></pre></div>
<p>Raw <code>NA</code> values are also considered “empty”:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># regular values are neither missing nor empty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.empty.html">is.empty</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># na("REASON") is a missing value, but is not an empty value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REASON"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.empty.html">is.empty</a></span><span class="op">(</span><span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"REASON"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># na(NA) values are considered missing and empty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.empty.html">is.empty</a></span><span class="op">(</span><span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># regular NA values are also missing and empty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/is.empty.html">is.empty</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>Empty values often occur as the result of joins, because the
<code>dplyr::*_join()</code> family of functions do not have a
<code>missing =</code> parameter, like <code><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">dplyr::if_else()</a></code>
does. For example, say we had the following data frame we wanted to join
to our sample:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conditions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">person_id</span>, <span class="op">~</span><span class="va">condition</span>,</span>
<span>  <span class="fl">1</span>, <span class="st">"TREATMENT"</span>,</span>
<span>  <span class="fl">2</span>, <span class="st">"CONTROL"</span>,</span>
<span>  <span class="fl">3</span>, <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"TECHNICAL_ERROR"</span><span class="op">)</span>,</span>
<span>  <span class="fl">6</span>, <span class="st">"CONTROL"</span>,</span>
<span>  <span class="fl">8</span>, <span class="st">"TREATMENT"</span>,</span>
<span><span class="op">)</span></span></code></pre></div>
<p>Because we’re missing condition information for some of the
respondents, these show up as empty values when we join the data frame
to our sample:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">conditions</span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">person_id</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 4</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color condition        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20 BLUE           TREATMENT        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> BLUE           CONTROL          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #BB0000;">&lt;TECHNICAL_ERROR&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>      <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1 <span style="color: #BB0000;">&lt;N/A&gt;</span>          <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41 RED            CONTROL          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>      <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30 YELLOW         TREATMENT        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> RED            <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span>           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #0000BB;">&lt;&lt;NA&gt;&gt;</span></span></span></code></pre></div>
<p>We can remedy this by replacing these empty values after the
join:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">conditions</span>, by <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/join_by.html" class="external-link">join_by</a></span><span class="op">(</span><span class="va">person_id</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    condition <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="../reference/is.empty.html">is.empty</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span>, <span class="fu"><a href="../reference/na.html">na</a></span><span class="op">(</span><span class="st">"LEFT_STUDY"</span><span class="op">)</span>, <span class="va">condition</span><span class="op">)</span>,</span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 4</span></span></span>
<span><span class="co">#&gt;    person_id       age favorite_color condition        </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl,fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr,fct&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1        20 BLUE           TREATMENT        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> BLUE           CONTROL          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3        21 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #BB0000;">&lt;TECHNICAL_ERROR&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4        30 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>      <span style="color: #BB0000;">&lt;LEFT_STUDY&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5         1 <span style="color: #BB0000;">&lt;N/A&gt;</span>          <span style="color: #BB0000;">&lt;LEFT_STUDY&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6        41 RED            CONTROL          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7        50 <span style="color: #BB0000;">&lt;OMITTED&gt;</span>      <span style="color: #BB0000;">&lt;LEFT_STUDY&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8        30 YELLOW         TREATMENT        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 <span style="color: #BB0000;">&lt;REFUSED&gt;</span> <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #BB0000;">&lt;LEFT_STUDY&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 <span style="color: #BB0000;">&lt;OMITTED&gt;</span> RED            <span style="color: #BB0000;">&lt;LEFT_STUDY&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11        10 <span style="color: #BB0000;">&lt;REFUSED&gt;</span>      <span style="color: #BB0000;">&lt;LEFT_STUDY&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="writing-interlaced-files">Writing interlaced files<a class="anchor" aria-label="anchor" href="#writing-interlaced-files"></a>
</h2>
<p>After you’ve made made changes to your data, you probably want to
save them. interlacer provides the <code>write_interlaced_*</code>
family of functions for this:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/write_interlaced_delim.html">write_interlaced_csv</a></span><span class="op">(</span><span class="va">df</span>, <span class="st">"interlaced_output.csv"</span><span class="op">)</span></span></code></pre></div>
<p>This will combine the value and missing reasons into interlaced
character columns, and write the result as a csv. Alternatively, if you
want to re-interlace the columns without writing to a file for more
control in the writing process, you can use
<code><a href="../reference/flatten_channels.html">flatten_channels()</a></code>:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/flatten_channels.html">flatten_channels</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id age     favorite_color</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1 20      BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2 REFUSED BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3 21      REFUSED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4 30      OMITTED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5 1       N/A           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6 41      RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7 50      OMITTED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8 30      YELLOW        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9 REFUSED REFUSED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10 OMITTED RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11 10      REFUSED</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># (it works on single vectors as well)</span></span>
<span><span class="fu"><a href="../reference/flatten_channels.html">flatten_channels</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">age</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "20"      "REFUSED" "21"      "30"      "1"       "41"      "50"     </span></span>
<span><span class="co">#&gt;  [8] "30"      "REFUSED" "OMITTED" "10"</span></span></code></pre></div>
<p>The value and missing reason channels of data frames with
<code>interlaced</code> vectors can similarly be accessed using the
<code><a href="../reference/value_channel.html">value_channel()</a></code> and <code><a href="../reference/value_channel.html">na_channel()</a></code> helper
functions:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/value_channel.html">value_channel</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id   age favorite_color</span></span>
<span><span class="co">#&gt;        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>         1    20 BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>         2    <span style="color: #BB0000;">NA</span> BLUE          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>         3    21 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>         4    30 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>         5     1 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>         6    41 RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>         7    50 <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>         8    30 YELLOW        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>         9    <span style="color: #BB0000;">NA</span> <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>        10    <span style="color: #BB0000;">NA</span> RED           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>        11    10 <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/value_channel.html">na_channel</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11 × 3</span></span></span>
<span><span class="co">#&gt;    person_id age     favorite_color</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> <span style="color: #BB0000;">NA</span>        REFUSED <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      REFUSED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      OMITTED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      N/A           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      OMITTED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> <span style="color: #BB0000;">NA</span>        REFUSED REFUSED       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> <span style="color: #BB0000;">NA</span>        OMITTED <span style="color: #BB0000;">NA</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      REFUSED</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>So far, we’ve covered how interlacer’s <code>read_interlaced_*</code>
family of functions enabled us to load <code>interlaced</code> columns
that contain separate challens for value and missing reasons. The
<code>interlaced</code> type enables us to create tidy and type-aware
pipelines that can flexibly consider a variable’s value AND missing
reasons.</p>
<p>In all the examples in this vignette, column types were automatically
detected. To explicitly specify value and missing column types, (and
specify individual missing reasons for specific columns), interlacer
extends <code>readr</code>’s <code>collector()</code> system. This will
be covered in the next vignette,
<code>vignette("na-column-types")</code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kyle Husmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
