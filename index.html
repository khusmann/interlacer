<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Textual tabular data sources often encode values and missing
    reasons into the same texkual column. This packages loads such data
    and deinterlaces the tabular source into a dataframe with two columns
    per variable: one for values, and one for missing reasons. This
    representation provides a tidy and typesafe interface for working with
    values and missing reasons in R.">
<title>Read Tabular Data With Interlaced Values And Missing Reasons • interlacer</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Read Tabular Data With Interlaced Values And Missing Reasons">
<meta property="og:description" content="Textual tabular data sources often encode values and missing
    reasons into the same texkual column. This packages loads such data
    and deinterlaces the tabular source into a dataframe with two columns
    per variable: one for values, and one for missing reasons. This
    representation provides a tidy and typesafe interface for working with
    values and missing reasons in R.">
<meta property="og:image" content="http://kylehusmann.com/interlacer/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">interlacer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/interlacer.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/mutations.html">Mutating Values and Missing Reasons</a>
    <a class="dropdown-item" href="articles/column-types.html">Interlaced Column Types</a>
    <a class="dropdown-item" href="articles/coded-data.html">Coded Data</a>
    <a class="dropdown-item" href="articles/other-approaches.html">Other Approaches</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="interlacer-">interlacer <a class="anchor" aria-label="anchor" href="#interlacer-"></a>
</h1>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>When a value is missing in your data, sometimes you want to know <em>why</em> it is missing. Many textual tabular data sources will encode missing reasons as special values <em>interlaced</em> with the regular values in a column (e.g. <code>N/A</code>, <code>REFUSED</code>, <code>-99</code>, etc.). Unfortunately, the missing reasons are lost when these values are all converted into a single <code>NA</code> type. Working with missing reasons in R traditionally requires loading variables as character vectors and doing a bunch of string comparisons and type conversions to make sense of them.</p>
<p>Interlacer was created based on the insight that values and missing reasons can be handled as separate <em>channels</em> of the same variable. Interlacer provides functions that load variables from interlaced data sources into two separate columns: One containing the variable’s values, the other containing its missing reasons. As it turns out, this structure gives us an extremely powerful and expressive way to simultaneously work with values and missing reasons in tidy pipelines, as described in <code><a href="articles/interlacer.html">vignette("interlacer")</a></code>. (tldr: It allows us to interact with a variable as a <a href="https://en.wikipedia.org/wiki/Result_type" class="external-link"><code>Result</code> type</a>, an abstraction often found in functional programming)</p>
<p>Although this may seem like a simple premise on the surface, it has deep implications! In addition to <code><a href="articles/interlacer.html">vignette("interlacer")</a></code>, be sure to also check out:</p>
<ul>
<li><p><code><a href="articles/mutations.html">vignette("mutations")</a></code> for a discussion on how to motify data frames when in this format</p></li>
<li><p><code><a href="articles/column-types.html">vignette("column-types")</a></code> to see how to handle variable-level missing reasons</p></li>
<li><p><code><a href="articles/coded-data.html">vignette("coded-data")</a></code> for some recipies for working with coded data (e.g. data produced by SPSS, SAS or Stata)</p></li>
<li><p><code><a href="articles/other-approaches.html">vignette("other-approaches")</a></code> for a deep dive into how interlacer’s approach compares to other approaches for representing and manipulating missing reasons alongside data values</p></li>
</ul>
<p>This library is currently in its experimental stages, so be aware that its interface is likely to change in the future. In the meantime, please try it out and <a href="mailto:kdh38@psu.edu">let me know what you think</a>!</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The easiest way to get interlacer is to install via devtools:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="co"># If devtools is not already installed</span></span>
<span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"khusmann/interlacer"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>To use interlacer, load it into your current R session:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://kylehusmann.com/interlacer/">interlacer</a></span><span class="op">)</span></span></code></pre></div>
<p>interlacer supports the following file formats with these <code>read_interlaced_*()</code> functions, which extend the <code>readr::read_*()</code> family of functions:</p>
<ul>
<li><code><a href="reference/read_interlaced_delim.html">read_interlaced_csv()</a></code></li>
<li><code><a href="reference/read_interlaced_delim.html">read_interlaced_tsv()</a></code></li>
<li><code><a href="reference/read_interlaced_delim.html">read_interlaced_csv2()</a></code></li>
<li><code><a href="reference/read_interlaced_delim.html">read_interlaced_delim()</a></code></li>
</ul>
<p>As a quick demo, consider the following example file bundled with interlacer:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_file.html" class="external-link">read_file</a></span><span class="op">(</span><span class="fu"><a href="reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; person_id,age,favorite_color</span></span>
<span><span class="co">#&gt; 1,20,BLUE</span></span>
<span><span class="co">#&gt; 2,REFUSED,BLUE</span></span>
<span><span class="co">#&gt; 3,21,REFUSED</span></span>
<span><span class="co">#&gt; 4,30,OMITTED</span></span>
<span><span class="co">#&gt; 5,1,N/A</span></span>
<span><span class="co">#&gt; 6,41,RED</span></span>
<span><span class="co">#&gt; 7,50,OMITTED</span></span>
<span><span class="co">#&gt; 8,30,YELLOW</span></span>
<span><span class="co">#&gt; 9,REFUSED,REFUSED</span></span>
<span><span class="co">#&gt; 10,OMITTED,RED</span></span>
<span><span class="co">#&gt; 11,10,REFUSED</span></span></code></pre></div>
<p>In this csv file, values are interlaced with three possible missing reasons: <code>REFUSED</code>, <code>OMITTED</code>, and <code>N/A</code>.</p>
<p>With <code>readr</code>, loading these data would result in a data frame like this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REFUSED"</span>, <span class="st">"OMITTED"</span>, <span class="st">"N/A"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 11 Columns: 3</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (1): favorite_color</span></span>
<span><span class="co">#&gt; dbl (2): person_id, age</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; # A tibble: 11 × 3</span></span>
<span><span class="co">#&gt;    person_id   age favorite_color</span></span>
<span><span class="co">#&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         </span></span>
<span><span class="co">#&gt;  1         1    20 BLUE          </span></span>
<span><span class="co">#&gt;  2         2    NA BLUE          </span></span>
<span><span class="co">#&gt;  3         3    21 &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  4         4    30 &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  5         5     1 &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  6         6    41 RED           </span></span>
<span><span class="co">#&gt;  7         7    50 &lt;NA&gt;          </span></span>
<span><span class="co">#&gt;  8         8    30 YELLOW        </span></span>
<span><span class="co">#&gt;  9         9    NA &lt;NA&gt;          </span></span>
<span><span class="co">#&gt; 10        10    NA RED           </span></span>
<span><span class="co">#&gt; 11        11    10 &lt;NA&gt;</span></span></code></pre></div>
<p>With interlacer, we get a “deinterlaced data frame” instead:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">ex</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read_interlaced_delim.html">read_interlaced_csv</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="reference/interlacer_example.html">interlacer_example</a></span><span class="op">(</span><span class="st">"colors.csv"</span><span class="op">)</span>,</span>
<span>  na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REFUSED"</span>, <span class="st">"OMITTED"</span>, <span class="st">"N/A"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A deinterlaced tibble: 11 × 6</span></span>
<span><span class="co">#&gt;    person_id .person_id.   age .age.   favorite_color .favorite_color.</span></span>
<span><span class="co">#&gt;        &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt; &lt;fct&gt;   &lt;chr&gt;          &lt;fct&gt;           </span></span>
<span><span class="co">#&gt;  1         1 &lt;NA&gt;           20 &lt;NA&gt;    BLUE           &lt;NA&gt;            </span></span>
<span><span class="co">#&gt;  2         2 &lt;NA&gt;           NA REFUSED BLUE           &lt;NA&gt;            </span></span>
<span><span class="co">#&gt;  3         3 &lt;NA&gt;           21 &lt;NA&gt;    &lt;NA&gt;           REFUSED         </span></span>
<span><span class="co">#&gt;  4         4 &lt;NA&gt;           30 &lt;NA&gt;    &lt;NA&gt;           OMITTED         </span></span>
<span><span class="co">#&gt;  5         5 &lt;NA&gt;            1 &lt;NA&gt;    &lt;NA&gt;           N/A             </span></span>
<span><span class="co">#&gt;  6         6 &lt;NA&gt;           41 &lt;NA&gt;    RED            &lt;NA&gt;            </span></span>
<span><span class="co">#&gt;  7         7 &lt;NA&gt;           50 &lt;NA&gt;    &lt;NA&gt;           OMITTED         </span></span>
<span><span class="co">#&gt;  8         8 &lt;NA&gt;           30 &lt;NA&gt;    YELLOW         &lt;NA&gt;            </span></span>
<span><span class="co">#&gt;  9         9 &lt;NA&gt;           NA REFUSED &lt;NA&gt;           REFUSED         </span></span>
<span><span class="co">#&gt; 10        10 &lt;NA&gt;           NA OMITTED RED            &lt;NA&gt;            </span></span>
<span><span class="co">#&gt; 11        11 &lt;NA&gt;           10 &lt;NA&gt;    &lt;NA&gt;           REFUSED</span></span></code></pre></div>
<p>Deinterlaced data frames have two columns for each variable: one for values, and another for missing reasons. Missing reason columns are denoted by column names surrounded by dots (e.g. <code>.age.</code> is the missing reason for the <code>age</code> column). When a value is <code>NA</code>, it always has a reason in the missing reason column. Similarly, when a missing reason is <code>NA</code>, it always has a value in the value column.</p>
<p>This allows us to separately reference values and missing reasons in a tidy and type-aware manner. For example, if I wanted to get a breakdown of the mean age of respondents missing a report of their favorite color, grouped by the missing reason, it would simply be:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">age</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .by <span class="op">=</span> <span class="va">.favorite_color.</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 4 × 3</span></span>
<span><span class="co">#&gt;   .favorite_color. mean_age     n</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;               &lt;dbl&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt; 1 &lt;NA&gt;                 30.3     5</span></span>
<span><span class="co">#&gt; 2 REFUSED              15.5     3</span></span>
<span><span class="co">#&gt; 3 OMITTED              40       2</span></span>
<span><span class="co">#&gt; 4 N/A                   1       1</span></span></code></pre></div>
<p>(Note that the <code>&lt;NA&gt;</code> category in the result refers to the mean age of responses <em>without</em> missing color values, i.e. with available favorite color responses).</p>
<p>But this just scratches the surface of what can be done with interlacer… check out <code><a href="articles/interlacer.html">vignette("interlacer")</a></code> for a more complete overview!</p>
</div>
<div class="section level2">
<h2 id="known-issues">Known Issues<a class="anchor" aria-label="anchor" href="#known-issues"></a>
</h2>
<p>Large data frames (many columns &amp; rows) are slow to run and print with interlacer. Deinterlaced data frames are validated to check that they conform to the rule of “one value OR missing reason per row”, and this check is done completely in R. There are a few key places (noted in the source) that would extremely benefit from a native implementation, and make the library much more snappy. Before I invest the time in that though, I want to get enough feedback from users of this package to stabilize the current approach / API. (If you find this package useful, please <a href="mailto:kdh38@psu.edu">let me know</a>!)</p>
<p>In the meantime, if your deinterlaced data frames are too slow to print, you can disable row-level validation by setting this option in your current session:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>interlacer.print_validation <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>When <code>interlacer.print_validation = FALSE</code>, you will need to be extra careful during mutations, because if you create an invalid state you won’t get a warning!</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>Apache License (&gt;= 2)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing interlacer</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kyle Husmann <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Kyle Husmann.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
